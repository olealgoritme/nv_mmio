Taken from envytools project.

Copyright (C) envytools
https://github.com/envytools/envytools
